\input{figures/error_categories}
\input{figures/error_count}

\input{6-illegal}
\subsection{Detailed Error Analysis}
\label{sec:app_error_analysis}
\input{figures/pseudo_legal_errors}

In this section we conduct a more in-depth analysis of errors made by the UCI model trained with Train-L for the ending square prediction task. We limit our focus to the two main error categories, namely, Pseudo Legal and Path Obstruction.



\begin{table}[t]
	\centering{
		\caption{Pseudo Legal error counts for different categories. For the total column we remove instances with errors of other category.}
		\label{tab:pseudo_legal}
		\begin{tabular}{lcccc}
			\toprule
			Category & \multicolumn{2}{c}{End-Actual} & \multicolumn{2}{c}{End-Other}\\
			& Errors & Total & Errors & Total \\
			\midrule
			Check + King 		& 1	& \phantom{1}27  & \phantom{1}2 & \phantom{1}20	\\
			Check + Other 		& 7	& \phantom{1}26  & 16			& \phantom{1}33 \\ 			 
			No Check + King 	& 4	& 101 			& 31 			& 296	\\ 
			No Check + Other 	& 0 & 835 &	\phantom{1}0  			& 619	\\ 
			\midrule
			Total 				& 12 & 989  	& 49 			& 968\\\bottomrule
		\end{tabular}
	}
	
\end{table}

\begin{table}[ht]
	\caption{Piece type counts for Path Obstruction error category. For the total column we remove instances with errors of other category.}
	\label{tab:path_obs}
	\centering
	\begin{tabular}{lcccc}
		\toprule
		Piece type & \multicolumn{2}{c}{End-Actual} & \multicolumn{2}{c}{End-Other} \\ %
		& Errors & Total & Errors & Total \\
		\midrule
		Rook (\pos{R}) 	& 	3 	& 355	& 17  			& 267    		\\ 
		Knight (\pos{N}) 	& 	1  	& 144	& \phantom{1}1 	& 131 			\\  
		Bishop (\pos{B}) 	& 	1 	& 162	& \phantom{1}3 	& 164 			\\
		Queen (\pos{Q}) 	& 	4  	& 202	& \phantom{1}4  & \phantom{1}99	\\ 
		King (\pos{K}) 	& 	1  	& 124 	& \phantom{1}1  & 284			\\
		\midrule
		Total 		& 	10 	& 987  	& 26 			& 945\\\bottomrule
	\end{tabular}
\end{table}

\subsection{Pseudo Legal Errors}
\label{sec:pseudo_legal}
We conduct our analysis by categorizing instances according to: (a) if the king was in check before the current move, and (b) if the king is being moved in the current move. 
Figure~\ref{fig:pseudo_legal_errors} presents one instance for each of these four categories.
Table~\ref{tab:pseudo_legal} presents the breakdown of errors for the End-Actual and End-Other instances. The key takeaways from the error categorization are: (a) Error counts for ``Check + King" and ``No Check + Other" are relatively low and similar across the two classes of prompts. (b) ``Check + Other" i.e.\ the king is in check and some other piece is moved, has high count for both the splits. The particularly high count for End-Other could be explained by the lack of ``meaningful" moves for certain prompts of this kind. For example, in figure~\ref{fig:error_check_no_king} the prompt asks for the queen at \pos{c8} to move, and the only legal continuation is for the queen to bring itself to the firing line at \pos{c7}. (c) ``No Check + King"  is another common error category. 
The significantly higher error count for End-Other could be due to a combination of the higher frequency of such prompts and the out-of-distribution prompts.
 


\input{figures/path_obstruction_errors}

\subsection{Path Obstruction}
Table~\ref{tab:path_obs} presents the path obstruction errors for different piece types for the End-Actual and End-Other task. Figure~\ref{fig:path_obstruction} represents instances of path obstruction error for different piece types.  
The error counts show that piece types with more dynamic movement except knight i.e. rook, bishop, and queen, have more path obstruction errors  (a knight just needs to avoid landing on its own piece to avoid path obstruction errors). 
These piece types also show a significant increase in frequency of path obstruction errors for End-Other in comparison to End-Actual. As in pseudo legal errors, this could again be due to the out-of-distribution nature of these prompts. Figure~\ref{fig:path_length} shows that the average path length for predicted moves with path obstruction error is significantly higher than the legal predictions for both the kinds of prompts (knight and king have a constant path length). \footnote{Path length is measured in number of king moves i.e. number of moves it will take a king to go from starting to ending square.}
