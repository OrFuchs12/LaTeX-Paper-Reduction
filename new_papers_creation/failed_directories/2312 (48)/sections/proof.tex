\section{Proof of Main Theorem}
\label{app:proof}

\begin{theorem} (Recap of Th.~\ref{th:main}) We let $\mathbb{E}[p_{in}(\*z)|{\*z \in \mathcal{Z}_{in}}] - \mathbb{E}[p_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}] = \Delta(m)$ as a function of the feature's dimensionality $m$. We have the following bound:
    \begin{align}
            \hat{\Delta}(m) & \geq \Delta(m) - O((\frac{k}{N})^{\frac{1}{m}} + k^{-\frac{1}{2}})
    \end{align}
\label{th:sup_main}
\end{theorem}

\begin{proof}

\begin{align*}
     &\mathbb{E}[p_{in}(\*z)|{\*z \in \mathcal{Z}_{in}} ]  - 
    \mathbb{E}[p_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}]
    \\ 
    &~~=  \mathbb{E}[p_{in}(\*z) - \hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{in}}] + 
    \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{in}}] \\
    &~- \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}] +
    \mathbb{E}[\hat{p}_{in}(\*z) - p_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}] 
    \\ &~~\leq  \mathbb{E}[|p_{in}(\*z) - \hat{p}_{in}(\*z)| | {\*z \in \mathcal{Z}_{in}}] + 
    \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{in}}]\\
    &~- \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}] +
    \mathbb{E}[|\hat{p}_{in}(\*z) - p_{in}(\*z)| | {\*z \in \mathcal{Z}_{out}}] 
    \\
    &~~= \frac{\int_{\mathcal{Z}_{in}} |p_{in}(\*z) - \hat{p}_{in}(\*z)| p_{in}(\*z) d\*z }{\int_{\mathcal{Z}_{in}}  p_{in}(\*z) d\*z } \\
    &~+ \frac{\int_{\mathcal{Z}_{out}} |p_{in}(\*z) - \hat{p}_{in}(\*z)| p_{in}(\*z) d\*z }{\int_{\mathcal{Z}_{out}}  p_{in}(\*z) d\*z }  \\
    &~+  \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{in}}] - \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}]\\
    \\ &\leq \frac{\int_{\mathcal{Z}_{in}} |p_{in}(\*z) - \hat{p}_{in}(\*z)| p_{in}(\*z) d\*z  + \int_{\mathcal{Z}_{out}} |p_{in}(\*z) - \hat{p}_{in}(\*z)| p_{in}(\*z) d\*z }{\min(\int_{\mathcal{Z}_{in}}  p_{in}(\*z) d\*z, \int_{\mathcal{Z}_{out}}  p_{in}(\*z) d\*z) }\\
    &~+ \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{in}}] - \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}] \\
    \\ &~~= \frac{\int_{\mathcal{Z}} |p_{in}(\*z) - \hat{p}_{in}(\*z)| p_{in}(\*z) d\*z  }{\min(\int_{\mathcal{Z}_{in}}  p_{in}(\*z) d\*z, \int_{\mathcal{Z}_{out}}  p_{in}(\*z) d\*z) } \\
    &~+ \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{in}}] - \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}]
    \\ &~~= \frac{\mathbb{E}[|p_{in}(\*z) - \hat{p}_{in}(\*z)|] }{\min(\int_{\mathcal{Z}_{in}}  p_{in}(\*z) d\*z, \int_{\mathcal{Z}_{out}}  p_{in}(\*z) d\*z) } \\
    &~+ \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{in}}] - \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}].
\end{align*}


\begin{lemma}
According to Theorem 1 in ~\cite{zhao2022analysis}, the estimation error of $k$-NN distances can be bounded by:
$$
\mathbb{E}[|p_{in}(\*z) - \hat{p}_{in}(\*z)|]  \leq \mathcal{O}(\left(\frac{k}{N}\right)^{\frac{1}{m}} + k^{-\frac{1}{2}})
$$
\label{lemma:est_err}
\end{lemma}
By Lemma~\ref{lemma:est_err}, we have the final results: 
\begin{align*}
     \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{in}}] - & \mathbb{E}[\hat{p}_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}] \geq \mathbb{E}[p_{in}(\*z)|{\*z \in \mathcal{Z}_{in}} ] \\
     &- \mathbb{E}[p_{in}(\*z)|{\*z \in \mathcal{Z}_{out}}] - O((\frac{k}{N})^{\frac{1}{m}} + k^{-\frac{1}{2}})
\end{align*}

\end{proof}
